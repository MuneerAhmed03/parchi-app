This file is a merged representation of the entire codebase, combining all repository files into a single document.
Generated by Repopack on: 2024-12-21T18:14:11.942Z

# File Summary

## Purpose
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.

## File Format
The content is organized as follows:
1. This summary section
2. Repository information
3. Repository structure
4. Multiple file entries, each consisting of:
  a. A header with the file path (## File: path/to/file)
  b. The full contents of the file in a code block

## Usage Guidelines
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.

## Notes
- Some files may have been excluded based on .gitignore rules and Repopack's
  configuration.
- Binary files are not included in this packed representation. Please refer to
  the Repository Structure section for a complete list of file paths, including
  binary files.

## Additional Info

For more information about Repopack, visit: https://github.com/yamadashy/repopack

# Repository Structure
```
src/
  app/
    api/
      room/
        create.ts
        join.ts
    game/
      page.tsx
    lobby/
      page.tsx
    globals.css
    layout.tsx
    page.tsx
  components/
    game/
      game-component.tsx
      game-header.tsx
      game-player-card.tsx
      hand.tsx
      parchi.tsx
      winner-modal.tsx
    lobby/
      header.tsx
      lobby-component.tsx
      status-bar.tsx
      user-card.tsx
    ui/
      button.tsx
      dialog.tsx
      input.tsx
      label.tsx
      popover.tsx
    parchi-svg.tsx
    Parchi.tsx
    StackedParchi.tsx
  context/
    GameContext.tsx
    RoomContext.tsx
    useGame.tsx
    useWebSocket.tsx
  lib/
    rooms.ts
    types.ts
    utils.ts
  store/
    indexedDB.ts
.gitignore
components.json
next.config.ts
package.json
postcss.config.mjs
README.md
tailwind.config.ts
tsconfig.json
```

# Repository Files

## File: src/app/api/room/create.ts
```typescript
import { v4 as uuidv4 } from "uuid";

const BASE_URL = process.env.NEXT_PUBLIC_BASE_URL;

export const createRoom = async (): Promise<string> => {
  const apiUrl = `${BASE_URL}/create-room`;
  const playerId = uuidv4();

  try {
    const response = await fetch(apiUrl, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({ playerId }),
    });

    if (!response.ok) {
      const errorMessage = await response.text();
      throw new Error(`Failed to create room: ${errorMessage}`);
    }
    return await response.text(); // Room ID as a plain string
  } catch (error) {
    console.error("Error creating room:", error);
    throw error;
  }
};
```

## File: src/app/api/room/join.ts
```typescript
import { v4 as uuidv4 } from "uuid";

const BASE_URL = process.env.NEXT_PUBLIC_BASE_URL;

export const joinRoom = async (roomId: string, playerId: string): Promise<{ success: boolean }> => {
  const apiUrl = `${BASE_URL}/join-room`;

  try {
    const response = await fetch(apiUrl, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({ roomId, playerId }),
    });

    if (!response.ok) {
      const errorMessage = await response.text();
      throw new Error(`Failed to join room: ${errorMessage}`);
    }

    return await response.json();
  } catch (error) {
    console.error("Error joining room:", error);
    throw error;
  }
};
```

## File: src/app/game/page.tsx
```typescript
import GameComponent from "@/components/game/game-component";
import React from "react";

const Game = () => {
  return <GameComponent />;
};

export default Game;
```

## File: src/app/lobby/page.tsx
```typescript
import LobbyComponent from "@/components/lobby/lobby-component";
import React from "react";

const Lobby = () => {
  return (
    <div>
      <LobbyComponent />
    </div>
  );
};

export default Lobby;
```

## File: src/app/globals.css
```css
@tailwind base;
@tailwind components;
@tailwind utilities;

/* global.css */
@layer base {
  :root {
    --background: #ffa726;
    --foreground: #333333;
    --primary: #1976d2;
    --primary-foreground: #ffffff;
    --secondary: #ffcc80;
    --secondary-foreground: #333333;
    --accent: #ff7043;
    --accent-foreground: #ffffff;
    --destructive: #d32f2f;
    --destructive-foreground: #ffffff;
    --muted: #e0e0e0;
    --muted-foreground: #6d6d6d;
    --card: #ffffff;
    --card-foreground: #333333;
    --popover: #1976d2;
    --popover-foreground: #ffffff;
    --border: #e0e0e0;
    --input: #ffffff;
    --ring: #ffa726;
    --radius: 4px;
  }

  /* Optional: Apply Tailwind styles to global elements */
  body {
    @apply bg-[var(--background)] text-[var(--foreground)];
  }

  button {
    @apply rounded px-4 py-2 transition-all;
    background-color: var(--primary);
    color: var(--primary-foreground);
  }

  button:hover {
    background-color: #155a9a;
  }

  /* Utility classes for theme-based colors */
  .bg-accent {
    background-color: var(--accent);
    color: var(--accent-foreground);
  }

  .bg-secondary {
    background-color: var(--secondary);
    color: var(--secondary-foreground);
  }

  .border-default {
    border-color: var(--border);
  }
}
```

## File: src/app/layout.tsx
```typescript
import type { Metadata } from "next";
import localFont from "next/font/local";
import "./globals.css";
import { WebSocketProvider } from "@/context/RoomContext";
import { GameContextProvider } from "@/context/GameContext";

const geistSans = localFont({
  src: "./fonts/GeistVF.woff",
  variable: "--font-geist-sans",
  weight: "100 900",
});
const geistMono = localFont({
  src: "./fonts/GeistMonoVF.woff",
  variable: "--font-geist-mono",
  weight: "100 900",
});

const pencilFont = localFont({
  src: "/fonts/pencil.ttf",
  variable: "--font-pencil",
  weight: "100 300 500 900",
  style: "normal",
});

export const metadata: Metadata = {
  title: "Parchi App",
  description: "A sticky notes application",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <head>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
      </head>
      <body
        className={`
          ${pencilFont.variable} ${geistSans.variable} ${geistMono.variable} antialiased min-h-screen`}
      >
        <GameContextProvider>
        <WebSocketProvider>{children}</WebSocketProvider>
        </GameContextProvider>
      </body>
    </html>
  );
}
```

## File: src/app/page.tsx
```typescript
"use client";
import Image from "next/image";
import Banner from "@/assets/parchi_banner-removebg.svg";
import StackedParchi from "@/components/StackedParchi";
import { FiMenu } from "react-icons/fi";
import { Popover, PopoverContent, PopoverTrigger } from "@/components/ui/popover";
import { Dialog, DialogContent, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import React, { useEffect, useState } from "react";
import { useWebSocketContext } from "@/context/RoomContext";
import { useGameContext } from "@/context/GameContext";
import { createRoom, joinRoom } from "@/lib/rooms";
import { useRouter } from 'next/navigation';
import { PlayerLobby } from "@/lib/types";

export default function Home() {
  const router = useRouter();
  const [createRoomForm, setCreateRoomForm] = useState({
    name: ''
  });

  const [joinRoomForm, setJoinRoomForm] = useState({
    name: '',
    roomId: ''
  });
  const { 
    handleConnect,
    handleDisconnect,
    isConnected,
    messages,
    sendMessage,
    lastProcessedEventIndex,
    updateLastProcessedEventIndex } = useWebSocketContext();

  const {
    handlePlayerId,
    handleRoomId,
    handlePlayers
  } =useGameContext();

  const handleInputChange = (formType: 'create' | 'join', field: string) => (e: React.ChangeEvent<HTMLInputElement>) => {
    if (formType === 'create') {
      setCreateRoomForm(prev => ({
        ...prev,
        [field]: e.target.value
      }));
    } else {
      setJoinRoomForm(prev => ({
        ...prev,
        [field]: e.target.value
      }));
    }
  };

  const handleCreateRoom = async () => {
    try {
      const{playerId,roomId} = await createRoom(createRoomForm.name);



      // const playerId = localStorage.getItem('playerId');
      if (!playerId) {
        throw new Error("Player Id is missing");
      }

      handleRoomId(roomId);
      handlePlayerId(playerId);

      await handleConnect();
      if (!isConnected) {
        console.log("ws not connected");
        return true;
      }
      const result = await sendMessage({
        type: "join_room",
        roomId,
        playerId
      });
      console.log("send message result:",result);
    } catch (error) {
      console.error("Error creating room :", error)
    }
  };

  const handleJoinRoom = async () => {
    try{

      const success = await joinRoom(joinRoomForm.roomId, joinRoomForm.name);

      
      if (!success.playerId) {
        throw new Error("Player Id is missing");
      }


      if(!isConnected){
        console.log("ws not connected");
        return true;
      }

      handleRoomId(success.roomId);
      handlePlayerId(success.playerId);

      const result = sendMessage({
        type: "join_room",
        roomId:joinRoomForm.roomId,
        playerId : success.playerId
      })

    }catch(error){
      console.error("Error joining room :", error)
    }
  };

  useEffect(() => {
    if (messages.length > lastProcessedEventIndex + 1) {
      for (let i = lastProcessedEventIndex + 1; i < messages.length; i++) {
        const message = messages[i];
        if (message.type === "lobby") {
          setTimeout(() => {}, 1000);
          // localStorage.setItem("players", JSON.stringify(message.data));
          //@ts-ignore
          const updatedPlayers : PlayerLobby[] = message.data?.map((player) => ({
            playerName: player.name,
            playerId: player.id,
            title: player.title
          }));
          handlePlayers(updatedPlayers);
          router.push("/lobby");
          updateLastProcessedEventIndex(i);
          console.log(lastProcessedEventIndex);
          break;
        }else{
          console.log("messagefrom page.tsx",message);
        }
      }
      updateLastProcessedEventIndex(messages.length - 1);
    }
  }, [messages, lastProcessedEventIndex, updateLastProcessedEventIndex]);

  return (
    <div className="min-h-screen flex flex-col">
      <header className="w-full relative flex justify-center items-center py-4">
        <Popover>
          <PopoverTrigger className="absolute top-4 right-4 p-2 rounded-md hover:bg-gray-100 focus:outline-none" aria-label="Toggle Menu">
            <FiMenu className="text-3xl hover:text-gray-700 rounded-md" />
          </PopoverTrigger>
          <PopoverContent className="w-80 absolute top-4 right-4 p-2 rounded-md hover:bg-gray-100 focus:outline-none">
            <div className="grid gap-4">
              <div className="space-y-2">
                <h4 className="font-medium leading-none">Dimensions</h4>
                <p className="text-sm text-muted-foreground">Set the dimensions for the layer.</p>
              </div>
            </div>
          </PopoverContent>
        </Popover>

        <div className="relative w-full max-w-[500px] mx-auto">
          <Image src={Banner} alt="Banner" layout="responsive" width={500} height={216} className="w-full md:p-0 p-4" />
          <div className="absolute font-pencil inset-0 flex items-center justify-center">
            <h1 className="text-4xl font-bold text-[#1976d2] transform hover:scale-105 transition-transform drop-shadow-[2px_2px_2px_rgba(0,0,0,0.8)]">P a r c h i</h1>
          </div>
        </div>
      </header>

      <main className="flex-1 flex items-center justify-center font-pencil relative">
        <div className="w-full max-w-[90vw] h-[60vh] relative">
          <div className="absolute inset-0 z-20">
            <StackedParchi count={4} />
          </div>
          <div className="absolute inset-0 z-30 flex flex-col items-center justify-center gap-20">
            <Dialog>
              <DialogTrigger className="bg-white border-2 border-zinc-600 px-4 py-2   rotate-6 rounded-lg shadow-md text-primary hover:bg-gray-100 transition-colors min-w-32 min-h-12">Create Room</DialogTrigger>
              <DialogContent className="bg-white font-pencil">
                <DialogTitle className="text-center font-bold">Create Room</DialogTitle>
                <div className="grid gap-4 place-items-center py-4">
                  <div className="grid grid-cols-4 items-center gap-4">
                    <Label htmlFor="name" className="text-right font-bold">
                      Enter Name
                    </Label>
                    <Input
                      id="name"
                      className="col-span-3"
                      value={createRoomForm.name}
                      onChange={handleInputChange('create', 'name')}
                    />
                  </div>
                  <button className="w-full" onClick={handleCreateRoom}>Create Room</button>
                </div>
              </DialogContent>
            </Dialog>
            <Dialog>
              <DialogTrigger className="bg-white border-2 border-zinc-600 px-4 py-2 -rotate-6 rounded-lg shadow-md text-primary hover:bg-gray-100 transition-colors justify-items-stretch min-w-36 min-h-12">Join Room</DialogTrigger>
              <DialogContent className="bg-white font-pencil text-primary">
                <DialogTitle className="text-center font-bold">Join Room</DialogTitle>
                <div className="grid gap-4 place-items-center py-4">
                  <div className="grid grid-cols-4 items-center gap-4">
                    <Label htmlFor="name" className="text-right font-bold">
                      Enter Name
                    </Label>
                    <Input
                      id="name"
                      className="col-span-3"
                      value={joinRoomForm.name}
                      onChange={handleInputChange('join', 'name')}
                    />
                  </div>
                  <div className="grid grid-cols-4 items-center gap-4">
                    <Label htmlFor="roomID" className="text-right font-bold">
                      Enter Room ID
                    </Label>
                    <Input
                      id="roomId"
                      className="col-span-3"
                      value={joinRoomForm.roomId}
                      onChange={handleInputChange('join', 'roomId')}
                    />
                  </div>
                  <button className="w-full" onClick={handleJoinRoom}>Join Room</button>
                </div>
              </DialogContent>
            </Dialog>
          </div>
        </div>
      </main>
    </div>
  );
}
```

## File: src/components/game/game-component.tsx
```typescript
"use client";
import React, { useEffect, useState } from "react";
import GameHeader from "./game-header";
import GamePlayerCard from "./game-player-card";
import { PlayerView } from "@/lib/types";
import { useWebSocketContext } from "@/context/RoomContext";
import { useGameContext } from "@/context/GameContext";
import { Hand } from "./hand";
import WinnerModal from "./winner-modal";

const avatars = ["/user-avtars/avtar1.png","/user-avtars/avtar2.png","/user-avtars/avtar3.png","/user-avtars/avtar4.png"];

const GameComponent = () => {
  const {
    currentPlayerView,
    handlePlayerView
  } = useGameContext();
  
  const {
    isConnected,
    messages, 
    sendMessage, 
    lastProcessedEventIndex,
    updateLastProcessedEventIndex 
  } = useWebSocketContext();
  
  const [gameState, setGameState] = useState<PlayerView>();
  const [showWinnerModal, setShowWinnerModal] = useState(false);
  const [winner, setWinner] = useState("");

  useEffect(() => {
    const mountGame = async () => {
      const playerView = currentPlayerView;
      if (!playerView) {
        return;
      }
      setGameState(playerView);
    }

    mountGame();
  }, []);

  useEffect(() => {
    if (messages.length > lastProcessedEventIndex + 1) {
      for (let i = lastProcessedEventIndex + 1; i < messages.length; i++) {
        const message = messages[i];
        if (message.type === "gameState") {
          //@ts-ignore
          const updateGameState = message.data;
          setGameState(updateGameState);
          handlePlayerView(updateGameState);
        } else if (message.type === "game_end") {
          const winnerName = message.winner;
          setWinner(winnerName);
          setShowWinnerModal(true);
        }
      }
      updateLastProcessedEventIndex(messages.length - 1);
    }
  }, [messages, lastProcessedEventIndex, updateLastProcessedEventIndex]);

  return (
    <main className="flex flex-col justify-between gap-3 md:gap-5 h-screen w-screen overflow-hidden">
      <GameHeader />
      <div className="flex justify-around">
        {gameState?.players.slice(0, 3).map((player) => (
          <GamePlayerCard 
            key={player.id} 
            name={player.name} 
            avtar={avatars[Math.floor(Math.random()*4)]} 
          />
        ))}
      </div>
      <button className="bg-red-500 mt-3 rounded-full hover:scale-110 text-2xl text-center font-extrabold tracking-widest w-40 h-40 mx-auto">
        THAPP!!
      </button>
      <Hand 
        hand={gameState?.hand || []} 
        isTurn={gameState?.currentPlayerIndex === gameState?.playerIndex}
        handlePass={(message) => {
          console.log("Passing card:", message);
        }}
      />
      
      <WinnerModal 
        isOpen={showWinnerModal}
        winnerName={winner}
        onClose={() => setShowWinnerModal(false)}
      />
    </main>
  );
};

export default GameComponent;
```

## File: src/components/game/game-header.tsx
```typescript
import { Home, UserRound, Volume2 } from "lucide-react";

const GameHeader = () => {
  return (
    <header className="h-20 flex justify-between px-2 md:px-5 items-center bg-white bg-opacity-35 backdrop-blur-md shadow-sm">
      <button className="bg-transparent">
        <Home className="text-black" />
      </button>
      <div className="bg-white text-lg md:text-2xl text-black font-bold rounded-3xl px-4 py-1 md:px-8 md:py-2">Your Turn</div>
      <div className="flex gap-1 md:gap-5">
        <button className="bg-transparent">
          <Volume2 className="text-black" />
        </button>
        <button className="bg-transparent">
          <UserRound className="text-black" />
        </button>
      </div>
    </header>
  );
};

export default GameHeader;
```

## File: src/components/game/game-player-card.tsx
```typescript
import Image from "next/image";
import React, { FC } from "react";

interface GamePlayerCardProps {
  name: string;
  avtar: string;
}

const GamePlayerCard: FC<GamePlayerCardProps> = ({ name, avtar }) => {
  return (
    <div className="bg-white transition-transform transform hover:-translate-y-2 hover:scale-105 hover:shadow-2xl duration-300 ease-in-out rounded-xl shadow-lg py-3 px-4 border-2 border-black flex flex-col items-center gap-2">
      <div className="w-12 h-12 md:w-[70px] md:h-[70px] relative">
        <Image src={avtar} alt="user" fill={true} className="rounded-full border-2 border-black transition-transform transform hover:rotate-6" />
      </div>
      <p className="font-bold text-sm md:text-xl font-pencil">{name}</p>
    </div>
  );
};

export default GamePlayerCard;
```

## File: src/components/game/hand.tsx
```typescript
import React, { FC, useState } from "react";
import ParchiSvg from "@/components/parchi-svg";

interface HandProps {
  hand: { title: string; id: string }[];
  isTurn: boolean;
  handlePass?: (message: any) => void;
}

export const Hand: FC<HandProps> = ({ hand, isTurn, handlePass }) => {
  const [selectedCard, setSelectedCard] = useState<string | null>(null);

  const handleCardClick = (id: string) => {
    if (!isTurn) return;
    setSelectedCard(selectedCard === id ? null : id);
  };

  const handlePassClick = () => {
    if (handlePass && selectedCard) {
      handlePass({
        type: "pass_card",
        cardId: selectedCard,
      });
      setSelectedCard(null);
    }
  };

  return (
    <div className="relative w-full px-4 py-6">
      {/* Cards Container */}
      <div className="flex justify-center items-center gap-2 md:gap-4 flex-wrap">
        {hand.map((card) => (
          <div
            key={card.id}
            className={`relative cursor-pointer transition-all duration-300 hover:scale-105 
              ${selectedCard === card.id ? 'ring-2 ring-black ring-offset-2' : ''}`}
            onClick={() => handleCardClick(card.id)}
          >
            {/* Card Title */}
            <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-10">
              <span className="text-sm md:text-base font-bold text-gray-800 whitespace-nowrap">
                {card.title}
              </span>
            </div>
            
            {/* Parchi SVG */}
            <div className="w-24 md:w-32 h-32 md:h-40">
              <ParchiSvg className="w-full h-full" />
            </div>
          </div>
        ))}
      </div>

      {/* Pass Button */}
      {selectedCard && isTurn && (
        <div className="absolute bottom-0 left-1/2 transform -translate-x-1/2 mb-2">
          <button
            onClick={handlePassClick}
            className="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-full 
              font-bold shadow-lg transform transition-all duration-300 hover:scale-105"
          >
            PASS
          </button>
        </div>
      )}
    </div>
  );
};
```

## File: src/components/game/parchi.tsx
```typescript
import { FC } from "react";
import ParchiSvg from "../parchi-svg";

interface ParchiProps {
  playerId: number;
  selectedPlayer: number | null;
  setSelectedPlayer: (id: number | null) => void;
}

interface ParchiProp {
  
}

const Parchi: FC<ParchiProps> = ({ playerId, selectedPlayer, setSelectedPlayer }) => {
  const isSelected = selectedPlayer === playerId; // Check if this Parchi is selected

  return (
    <div className={`relative w-fit group hover:cursor-pointer transition-transform duration-500 hover:rotate-6 hover:-translate-y-2 hover:scale-110 ease-in-out hover:cursor lg:h-48 mr-2 ${isSelected && "border-2 border-black"}`} onClick={() => setSelectedPlayer(playerId)}>
      {/* Title on top */}
      <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 px-2 py-1">
        <span className="text-[10px] font-bold text-gray-700 group-hover:text-base transition-all duration-300">Raja</span>
      </div>

      {/* SVG Rendering */}
      <ParchiSvg className="w-full h-full " />

      {/* Pass Button */}
      {isSelected && (
        <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 transition-all duration-500 ease-in-out">
          <button
            className="bg-green-500 text-white border text-sm border-black font-bold py-1 px-3 md:text-xl rounded shadow-lg tracking-wide animate-bounce"
            onClick={(e) => {
              e.stopPropagation(); // Prevent parent click
              setSelectedPlayer(null); // Reset selected player
            }}
          >
            Pass
          </button>
        </div>
      )}
    </div>
  );
};

export default Parchi;
```

## File: src/components/game/winner-modal.tsx
```typescript
import React from 'react';
import ReactConfetti from 'react-confetti';
import { Dialog, DialogContent } from "@/components/ui/dialog";
import Image from 'next/image';
import { useRouter } from 'next/navigation';

interface WinnerModalProps {
  isOpen: boolean;
  winnerName: string;
  onClose: () => void;
}

const WinnerModal: React.FC<WinnerModalProps> = ({ isOpen, winnerName, onClose }) => {
  const router = useRouter();

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="bg-white font-pencil relative overflow-hidden border-4 border-black">
        {isOpen && <ReactConfetti recycle={true} numberOfPieces={200} />}
        
        <div className="flex flex-col items-center gap-6 py-8">
          {/* <div className="relative w-24 h-24">
            <Image
              src="/trophy.png"
              alt="Trophy"
              fill
              className="object-contain animate-bounce"
            />
          </div> */}
          
          <h2 className="text-4xl font-bold text-center text-primary animate-pulse">
            🎉 Winner! 🎉
          </h2>
          
          <div className="bg-[#ffa726] p-6 rounded-xl border-2 border-black transform rotate-2 shadow-lg">
            <p className="text-2xl font-bold text-center break-words">
              {winnerName}
            </p>
          </div>
          
          <button
            onClick={() => router.push('/')}
            className="mt-4 bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded-full 
              font-bold text-lg transform hover:scale-105 transition-all duration-300 
              border-2 border-black shadow-lg"
          >
            Play Again
          </button>
        </div>
      </DialogContent>
    </Dialog>
  );
};

export default WinnerModal;
```

## File: src/components/lobby/header.tsx
```typescript
import { CopyIcon } from "lucide-react";
import React from "react";

const Header = () => {
  return (
    <div className="bg-white max-w-[500px] w-full mx-auto flex flex-col gap-1 md:flex-row justify-between items-center px-2 py-1 md:px-5 md:py-3 border-2 border-black rounded-xl">
      <div className="font-extrabold text-lg md:text-xl inline-flex gap-2 items-center">
        Room ID: ABCD1234 <CopyIcon className="h-5 w-5 cursor-pointer text-gray-500" />
      </div>
      {/* Button to Leave Room */}
      <button className="bg-red-500 text-white text-sm md:text-base font-bold px-4 py-1 rounded-3xl">Leave Room</button>
    </div>
  );
};

export default Header;
```

## File: src/components/lobby/lobby-component.tsx
```typescript
"use client"
import React, { useEffect, useState, useRef } from "react";
import UserCard from "./user-card";
import Header from "./header";
import StatusBar from "./status-bar";
import { useWebSocketContext } from "@/context/RoomContext";
import { useGameContext } from "@/context/GameContext";
import { useRouter } from "next/navigation";
import {savePlayerView} from "@/store/indexedDB"
import { PlayerView, PlayerLobby } from "@/lib/types";

const avatars = ["/user-avtars/avtar1.png","/user-avtars/avtar2.png","/user-avtars/avtar3.png","/user-avtars/avtar4.png"]

const LobbyComponent = () => {
  const getRandomTilt = () => Math.random() * 4 - 2;
  const { 
    isConnected, 
    messages, 
    sendMessage, 
    lastProcessedEventIndex,
    updateLastProcessedEventIndex 
  } = useWebSocketContext();
  const {
    playerId,
    playersArr,
    handlePlayerView,
    handlePlayers
  } = useGameContext();
  const router = useRouter();
  const [players, setPlayers] = useState<PlayerLobby[]>([]);
  const [playerid,setPlayerid] = useState<string|null>(null);

  useEffect(()=>{
    // const playerListString = localStorage.getItem('players');
    // if(!playerListString){
    //   console.log("local storage empty");
    //   return;
    // }
    // const playeruuid = localStorage.getItem('playerId')
    // if(!playeruuid){
    //   console.log("local storage empty");
    //   return;
    // }
    // setPlayerid(playeruuid);
    // const playerList = JSON.parse(playerListString);
    // //@ts-ignore
    // const updatedPlayers = playerList?.map((player) => ({
    //   playerName: player.name,
    //   playerId: player.id,
    //   title: player.title
    // }));
    // setPlayers(updatedPlayers);
    setPlayerid(playerId);
    setPlayers(playersArr)
  },[])

  useEffect(() => {
    const saveToDB = async (playerView:PlayerView) => {
      await savePlayerView(playerView);
      console.log("saved to index");
    }
    if (messages.length > lastProcessedEventIndex + 1) {
      for (let i = lastProcessedEventIndex + 1; i < messages.length; i++) {
        const message = messages[i];
        if (message.type === "lobby") {
          //@ts-ignore
          const updatePlayers : Player[]= message.data.map((item)=>({
            playerName: item.name,
            playerId: item.id,
            title: item.title,
          }))

          setPlayers(updatePlayers);
          handlePlayers(updatePlayers)
        }else if (message.type === "game_start") {
          // setTimeout(() => {}, 1000);
          // saveToDB(message.data).then(()=>{
          //   updateLastProcessedEventIndex(messages.length - 1);
          //   router.push("/game");
          // });
          handlePlayerView(message.data)
          updateLastProcessedEventIndex(messages.length - 1);
          router.push("/game");
          console.log("break loggesd");
          break;
        }
      }
      updateLastProcessedEventIndex(messages.length - 1);
    }
  }, [messages, router, lastProcessedEventIndex, updateLastProcessedEventIndex]);

  const playerSlots = Array.from({ length: 4 }, (_, index) => players[index] || null);

  const currentIndex = playerSlots.findIndex(player => player?.playerId === playerid);

  return (
    <div className="bg-[#ffa726] px-3 py-5 flex flex-col justify-around gap-5 overflow-hidden w-screen h-screen">
      <Header />
      <div className="grid gap-3 grid-cols-1 p-2 md:grid-cols-2 lg:gap-5 justify-center place-items-center w-full md:w-fit mx-auto max-md:overflow-y-auto">
        {playerSlots.map((player, index) =>
          player ? (
            <UserCard
              key={player.playerId}
              playerName={player.playerName}
              playerAvtar={avatars[Math.floor(Math.random()*5)]}
              playerStatus={player.title} 
              tilt={getRandomTilt()}
              isCurrentPlayer={index === currentIndex}
              {...(isConnected?{handleSubmit:sendMessage}:{})}
            />
          ) : (
            <UserCard
              key={index}
              playerName={null}
              playerStatus={null} 
              isCurrentPlayer={false}
              tilt={getRandomTilt()}
            />
          )
        )}
      </div>
      <StatusBar playersReady={players.length} />
    </div>
  );
};

export default LobbyComponent;
```

## File: src/components/lobby/status-bar.tsx
```typescript
import React from "react";

// Define the prop types
interface StatusBarProps {
  playersReady: number; // playersReady should be a number
}

const StatusBar: React.FC<StatusBarProps> = ({ playersReady }) => {
  // Ensure playersReady is between 0 and 4
  const progress = Math.min(Math.max(playersReady, 0), 4);

  return (
    <div className="text-center font-pencil tracking-wide md:text-base text-sm flex flex-col gap-1 font-bold text-black">
      <div>{`${playersReady}/4 Players Ready`}</div>
      {/* Progress Bar */}
      <div className="h-3 md:h-5 max-w-[330px] w-full bg-white border-2 border-black mx-auto rounded-full my-1">
        <div
          className="h-full bg-green-400 rounded-full"
          style={{ width: `${(progress / 4) * 100}%` }}
        ></div>
      </div>
      <div>{progress === 4 ? "All players are ready!" : "Waiting for everyone to get ready!"}</div>
    </div>
  );
};

export default StatusBar;
```

## File: src/components/lobby/user-card.tsx
```typescript
"use client";
import Image from "next/image";
import React, { FC, useState } from "react";
import { Dialog, DialogContent, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Input } from "@/components/ui/input";

export interface UserCardProps {
  playerName: string | null;
  playerAvtar?: string;
  playerStatus: string | null;
  tilt: number;
  handleSubmit?: (message: any) => void;
  isCurrentPlayer: boolean;
}

const UserCard: FC<UserCardProps> = ({ playerName, playerAvtar, playerStatus, tilt, handleSubmit, isCurrentPlayer }) => {
  const [title, setTitle] = useState<string | null>(playerStatus);

  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {
    setTitle(event.target.value);
  };

  const handleButtonClick = () => {
    const roomId = localStorage.getItem('roomId');
    const playeruuid = localStorage.getItem('playerId')

    if(!roomId || !playeruuid){
      console.log("local storage empty");
      return;
    }
    if (handleSubmit) {
      handleSubmit({
        type: "submit_title",
        data: { 
          title,
          roomId,
          playerId:playeruuid},
      });
    }
  };

  const cardStyle = {
    transform: `rotate(${tilt}deg)`,
    transition: "transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out, scale 0.3s ease-in-out",
  };

  const handleMouseEnter = (e: React.MouseEvent<HTMLDivElement>) => {
    e.currentTarget.style.transform = `rotate(${tilt + 3}deg) scale(1.1)`;
    e.currentTarget.style.boxShadow = "0 5px 15px rgba(0, 0, 0, 0.2)";
  };

  const handleMouseLeave = (e: React.MouseEvent<HTMLDivElement>) => {
    e.currentTarget.style.transform = `rotate(${tilt}deg)`;
    e.currentTarget.style.boxShadow = "none";
  };

  return (
    <div
      className="bg-[#E6E6E6] flex flex-col p-3 items-center justify-around w-64 md:w-[340px] md:h-44 lg:w-[420px] lg:h-48 border-2 border-black"
      style={cardStyle}
      onMouseEnter={handleMouseEnter}
      onMouseLeave={handleMouseLeave}
    >
      <Image src={playerAvtar || ""} alt="user avatar" width={70} height={70} />
      <p className="font-bold text-lg md:text-xl font-pencil">
        {playerName || "Waiting for the user"}
      </p>
      {playerName && (
        <>
          {isCurrentPlayer ? (
            playerStatus === null ? (
              <Dialog>
                <DialogTrigger
                  className="bg-white text-black border-2 border-black hover:bg-[#ffa726] hover:text-white font-bold w-full rounded-3xl px-3 py-2"
                  disabled={!!playerStatus}
                >
                  Submit Title..
                </DialogTrigger>
                <DialogContent className="bg-white font-pencil text-primary">
                  <DialogTitle className="text-center font-bold">Submit Card Title</DialogTitle>
                  <div className="grid gap-4 place-items-center py-4">
                    <Input
                      id="roomId"
                      className="w-full font-semibold text-center"
                      value={title || ""}
                      onChange={handleChange}
                    />
                    <button className="w-full" onClick={handleButtonClick}>
                      Submit
                    </button>
                  </div>
                </DialogContent>
              </Dialog>
            ) : (
              <div className="text-center font-bold text-lg md:text-xl font-pencil">
                {playerStatus}
              </div>
            )
          ) : (
            <div className="text-center font-bold text-lg md:text-xl font-pencil">
              {playerStatus || "Waiting for player to submit title"}
            </div>
          )}
        </>
      )}
    </div>
  );
};

export default UserCard;
```

## File: src/components/ui/button.tsx
```typescript
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
  {
    variants: {
      variant: {
        default:
          "bg-primary text-primary-foreground shadow hover:bg-primary/90",
        destructive:
          "bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",
        outline:
          "border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",
        secondary:
          "bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",
        ghost: "hover:bg-accent hover:text-accent-foreground",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-9 px-4 py-2",
        sm: "h-8 rounded-md px-3 text-xs",
        lg: "h-10 rounded-md px-8",
        icon: "h-9 w-9",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "button"
    return (
      <Comp
        className={cn(buttonVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    )
  }
)
Button.displayName = "Button"

export { Button, buttonVariants }
```

## File: src/components/ui/dialog.tsx
```typescript
"use client"

import * as React from "react"
import * as DialogPrimitive from "@radix-ui/react-dialog"
import { X } from "lucide-react"

import { cn } from "@/lib/utils"

const Dialog = DialogPrimitive.Root

const DialogTrigger = DialogPrimitive.Trigger

const DialogPortal = DialogPrimitive.Portal

const DialogClose = DialogPrimitive.Close

const DialogOverlay = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Overlay
    ref={ref}
    className={cn(
      "fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
  />
))
DialogOverlay.displayName = DialogPrimitive.Overlay.displayName

const DialogContent = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DialogPortal>
    <DialogOverlay />
    <DialogPrimitive.Content
      ref={ref}
      className={cn(
        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
        className
      )}
      {...props}
    >
      {children}
      <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </DialogPrimitive.Close>
    </DialogPrimitive.Content>
  </DialogPortal>
))
DialogContent.displayName = DialogPrimitive.Content.displayName

const DialogHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col space-y-1.5 text-center sm:text-left",
      className
    )}
    {...props}
  />
)
DialogHeader.displayName = "DialogHeader"

const DialogFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",
      className
    )}
    {...props}
  />
)
DialogFooter.displayName = "DialogFooter"

const DialogTitle = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Title
    ref={ref}
    className={cn(
      "text-lg font-semibold leading-none tracking-tight",
      className
    )}
    {...props}
  />
))
DialogTitle.displayName = DialogPrimitive.Title.displayName

const DialogDescription = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Description
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
DialogDescription.displayName = DialogPrimitive.Description.displayName

export {
  Dialog,
  DialogPortal,
  DialogOverlay,
  DialogTrigger,
  DialogClose,
  DialogContent,
  DialogHeader,
  DialogFooter,
  DialogTitle,
  DialogDescription,
}
```

## File: src/components/ui/input.tsx
```typescript
import * as React from "react"

import { cn } from "@/lib/utils"

const Input = React.forwardRef<HTMLInputElement, React.ComponentProps<"input">>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          "flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
          className
        )}
        spellCheck={false}
        ref={ref}
        {...props}
      />
    )
  }
)
Input.displayName = "Input"

export { Input }
```

## File: src/components/ui/label.tsx
```typescript
"use client"

import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const labelVariants = cva(
  "text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
)

const Label = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &
    VariantProps<typeof labelVariants>
>(({ className, ...props }, ref) => (
  <LabelPrimitive.Root
    ref={ref}
    className={cn(labelVariants(), className)}
    {...props}
  />
))
Label.displayName = LabelPrimitive.Root.displayName

export { Label }
```

## File: src/components/ui/popover.tsx
```typescript
"use client"

import * as React from "react"
import * as PopoverPrimitive from "@radix-ui/react-popover"

import { cn } from "@/lib/utils"

const Popover = PopoverPrimitive.Root

const PopoverTrigger = PopoverPrimitive.Trigger

const PopoverAnchor = PopoverPrimitive.Anchor

const PopoverContent = React.forwardRef<
  React.ElementRef<typeof PopoverPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>
>(({ className, align = "center", sideOffset = 4, ...props }, ref) => (
  <PopoverPrimitive.Portal>
    <PopoverPrimitive.Content
      ref={ref}
      align={align}
      sideOffset={sideOffset}
      className={cn(
        "z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className
      )}
      {...props}
    />
  </PopoverPrimitive.Portal>
))
PopoverContent.displayName = PopoverPrimitive.Content.displayName

export { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }
```

## File: src/components/parchi-svg.tsx
```typescript
import React from "react";
interface ParchiSvgProps {
  className?: string;
}
const ParchiSvg: React.FC<ParchiSvgProps> = ({ className }) => {
  return (
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="20 15 110 170" preserveAspectRatio="xMidYMid meet" className={`${className}`}>
      {/* Background */}
      <rect width="100%" height="100%" fill="none" />
      {/* Paper Chit with Sharp Top and Bottom Edges and Curved Sides */}
      <path
        d="M20 15
           L30 15
           L120 15
           L130 15
           Q132 30, 130 50
           Q128 70, 130 90
           Q132 110, 130 130
           Q128 150, 130 170
           L130 185
           L120 185
           L30 185
           L20 185
           Q18 170, 20 150
           Q22 130, 20 110
           Q18 90, 20 70
           Q22 50, 20 30
           Z"
        fill="#ffffff"
        stroke="#d3d3d3"
        strokeWidth="1" // Use camelCase
      />
      {/* Horizontal Fold Crease */}
      <defs>
        <linearGradient id="horizontalFold" x1="0" y1="0" x2="1" y2="0">
          <stop offset="0%" stopColor="#d0d0d0" stopOpacity="0.1" /> {/* Use camelCase */}
          <stop offset="50%" stopColor="#b0b0b0" stopOpacity="0.3" />
          <stop offset="100%" stopColor="#d0d0d0" stopOpacity="0.1" />
        </linearGradient>
      </defs>
      <rect x="38" y="99" width="75" height="1" fill="url(#horizontalFold)" />
      {/* Vertical Fold Crease */}
      <defs>
        <linearGradient id="verticalFold" x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stopColor="#d0d0d0" stopOpacity="0.1" />
          <stop offset="50%" stopColor="#b0b0b0" stopOpacity="0.3" />
          <stop offset="100%" stopColor="#d0d0d0" stopOpacity="0.1" />
        </linearGradient>
      </defs>
      <rect x="74" y="30" width="1" height="145" fill="url(#verticalFold)" />
      {/* Shadow for Depth */}
      <path
        d="M22 17
           L32 17
           L118 17
           L128 17
           Q130 32, 128 52
           Q126 72, 128 92
           Q130 112, 128 132
           Q126 152, 128 172
           L128 187
           L118 187
           L32 187
           L22 187
           Q20 172, 22 152
           Q24 132, 22 112
           Q20 92, 22 72
           Q24 52, 22 32
           Z"
        fill="none"
        stroke="rgba(0, 0, 0, 0.1)"
        strokeWidth="3" // Use camelCase
      />
    </svg>
  );
};

export default ParchiSvg;
```

## File: src/components/Parchi.tsx
```typescript
import React from 'react';

const PaperChit = ({ className = '', rotate = false }) => (
  <svg
    className={className}
    xmlns="http://www.w3.org/2000/svg"
    viewBox="0 0 150 200"
    preserveAspectRatio="xMidYMid meet"
    style={{ transform: rotate ? 'rotate(180deg)' : 'none', transition: 'transform 0.3s ease' }}
  >
    {/* Background */}
    <rect width="100%" height="100%" fill="none" />

    {/* Paper Chit with Sharp Top and Bottom Edges and Curved Sides */}
    <path
      d="M20 15
         L30 15
         L120 15
         L130 15
         Q132 30, 130 50
         Q128 70, 130 90
         Q132 110, 130 130
         Q128 150, 130 170
         L130 185
         L120 185
         L30 185
         L20 185
         Q18 170, 20 150
         Q22 130, 20 110
         Q18 90, 20 70
         Q22 50, 20 30
         Z"
      fill="#ffffff"
      stroke="#d3d3d3"
      strokeWidth="1"
    />

    {/* Horizontal Fold Crease with Lighter Gradient Fade */}
    <defs>
      <linearGradient id="horizontalFold" x1="0" y1="0" x2="1" y2="0">
        <stop offset="0%" style={{ stopColor: '#d0d0d0', stopOpacity: 0.1 }} />
        <stop offset="50%" style={{ stopColor: '#b0b0b0', stopOpacity: 0.3 }} />
        <stop offset="100%" style={{ stopColor: '#d0d0d0', stopOpacity: 0.1 }} />
      </linearGradient>
    </defs>
    <rect x="38" y="99" width="75" height="1" fill="url(#horizontalFold)" />

    {/* Vertical Fold Crease with Lighter Gradient Fade */}
    <defs>
      <linearGradient id="verticalFold" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0%" style={{ stopColor: '#d0d0d0', stopOpacity: 0.1 }} />
        <stop offset="50%" style={{ stopColor: '#b0b0b0', stopOpacity: 0.3 }} />
        <stop offset="100%" style={{ stopColor: '#d0d0d0', stopOpacity: 0.1 }} />
      </linearGradient>
    </defs>
    <rect x="74" y="30" width="1" height="145" fill="url(#verticalFold)" />

    {/* Shadow for Depth */}
    <path
      d="M22 17
         L32 17
         L118 17
         L128 17
         Q130 32, 128 52
         Q126 72, 128 92
         Q130 112, 128 132
         Q126 152, 128 172
         L128 187
         L118 187
         L32 187
         L22 187
         Q20 172, 22 152
         Q24 132, 22 112
         Q20 92, 22 72
         Q24 52, 22 32
         Z"
      fill="none"
      stroke="rgba(0, 0, 0, 0.1)"
      strokeWidth="3"
    />
  </svg>
);

export default PaperChit;
```

## File: src/components/StackedParchi.tsx
```typescript
import React from 'react';
import PaperChit from '@/components/Parchi';

const StackedPaperChits = ({ count = 5 }) => {
  return (
    <div className="relative w-full h-full">
      {[...Array(count)].map((_, index) => (
        <div
          key={index}
          className="absolute inset-0"
          style={{
            transform: index === count - 1 ? 'none' : `rotate(${-4 + 3 * index}deg)`,
            zIndex: index,
          }}
        >
          <PaperChit className="w-full h-full" />
        </div>
      ))}
    </div>
  );
};

export default StackedPaperChits;
```

## File: src/context/GameContext.tsx
```typescript
"use client"
import React ,{ createContext,useContext,ReactNode,useState,useMemo }from 'react';
import { PlayerLobby, PlayerView } from '@/lib/types';

interface GameContextType{
    handlePlayerId:(player:string)=>void;
    handleRoomId:(room:string)=>void;
    handlePlayers:(playerArr:PlayerLobby[])=>void;
    handlePlayerView:(playerViewArg:PlayerView)=>void;
    playerId:string;
    roomId:string;
    playersArr:PlayerLobby[];
    currentPlayerView:PlayerView|null
}

const GameContext = createContext<GameContextType | undefined>(undefined);

export const GameContextProvider:React.FC<{children:ReactNode}>=({children})=>{
    const [roomId,setRoomId]=useState<string>("");
    const [playerId,setPlayerId]=useState<string>("");
    const [players,setPlayers]=useState<PlayerLobby[]>([]);
    const [playerView,setPlayerView]=useState<PlayerView|null>(null);

    const handlePlayerId = (player:string) => {
        setPlayerId(player);
    }
   const handleRoomId = (room:string) => {    setRoomId(room);
}
  const handlePlayers = (playerArr:PlayerLobby[]) => {
        setPlayers(playerArr);
    }
    const handlePlayerView = (playerViewArg:PlayerView) => {
        setPlayerView(playerViewArg)
    }

    const contextValue = useMemo(()=>({
        roomId,
        playerId,
        playersArr: players,
        currentPlayerView: playerView,
        handlePlayerId,
        handleRoomId,
        handlePlayers,
        handlePlayerView
    }),
    [ roomId, playerId , players, playerView]
)

    return (
        <GameContext.Provider value = { contextValue}>
            {children}
        </GameContext.Provider>
    )
}

export const useGameContext=()=>{
    const context = useContext(GameContext);
    if(!context){
        throw new Error("useGameContext must be used within GameContext provider")
    }
    return context;
}
```

## File: src/context/RoomContext.tsx
```typescript
"use client";
import React , {createContext,useContext,ReactNode,useRef,useState} from 'react';
import useWebSocket from './useWebSocket';
import { LargeNumberLike } from 'crypto';

interface WebSocketContextType{
    handleConnect:()=>void;
    handleDisconnect:()=>void;
    isConnected :boolean;
    messages:any[];
    sendMessage:(message:any)=>boolean;
    lastProcessedEventIndex : number;
    updateLastProcessedEventIndex: (index:number)=>void;
}

const WebSocketContext=createContext<WebSocketContextType | undefined>(undefined);

export const WebSocketProvider:React.FC<{children:ReactNode}>=({children}) =>{
    const { isConnected, messages, sendMessage, connect, disconnect } = useWebSocket('your-ws-url');
    const[lastProcessedEventIndex,setLastProcessedEventIndex]=useState<number>(-1);

    const updateLastProcessedEventIndex = (index:number)=>{
        setLastProcessedEventIndex(index);
    }


    const handleConnect = async () => {
        await connect();
    }
    const handleDisconnect = () => {
        disconnect();
    }

    return (
        <WebSocketContext.Provider value={{handleConnect,handleDisconnect,isConnected,messages,sendMessage,lastProcessedEventIndex,updateLastProcessedEventIndex}}>
            {children}
        </WebSocketContext.Provider>
    )
}

export const useWebSocketContext=()=>{
    const context = useContext(WebSocketContext);
    if(!context){
        throw new Error("useWebSocketContext must be used within a WebSocketProvider");
    }
    return context;
}
```

## File: src/context/useGame.tsx
```typescript
import {useEffect,useRef,useState} from 'react'
import {PlayerView, Player} from "@/lib/types"

const useGame=()=>{
    const [roomId,setRoomId]=useState<string|null>(null);
    const [playerId,setPlayerId]=useState<string|null>(null);
    const [players,setPlayers]=useState<Player[]>([]);
    const [gameState,setGameState]=useState<PlayerView|null>(null);

    return {roomId,playerId,players,setRoomId,setPlayerId,setPlayers,setGameState};
}

export default useGame;
```

## File: src/context/useWebSocket.tsx
```typescript
import {useEffect,useRef,useState} from 'react'

const useWebSocket=(url:string)=>{
    const [isConnected,setIsConnected]=useState(false);
    const [messages,setMessages]=useState<any[]>([]);
    const socketref = useRef<WebSocket|null>(null);
    const ws=socketref?.current;

    const connect = () => {

        return new Promise<void>((resolve,reject)=>{
            if (socketref.current){ 
                resolve();
                return;
            }

            const socket = new WebSocket(url);
        socketref.current = socket;

        socket.onopen = () => {
            console.log("ws connected");
            setIsConnected(true);
            resolve();
        }

        socket.onmessage = (event) => {
            console.log("Message Received: ",event.data);
            const message= JSON.parse(event.data);
            console.log("on message recieved",message);
            if(message==='ping'){
                socket.send('pong')
            }
            setMessages((prev)=>[...prev,message]);
        }

        socket.onclose = (event) => {
            console.warn("ws closed:", event.reason);
            setIsConnected(false);
            socketref.current = null;
        }

        socket.onerror = (error) => {
            console.log("ws error", error);
            socket.close();
            reject(error);
        }
    })
    }

    const disconnect = () => {
        if (socketref.current) {
            socketref.current.close();
            socketref.current = null;
            setIsConnected(false);
        }
    }

    useEffect(()=>{
        return () => {
            disconnect();
        };
    },[url])

    const sendMessage = (message:any) =>{
        console.log("send Messahge called: ", message);
        if(ws && ws.readyState == WebSocket.OPEN){
            ws.send(JSON.stringify(message));
            return true;
        }else{
            console.warn("WebSocket is not open");
            return false;
        }
    };

    return {isConnected,messages, sendMessage, connect, disconnect};
};

export default useWebSocket;
```

## File: src/lib/rooms.ts
```typescript
import { v4 as uuidv4 } from "uuid";

const BASE_URL = 'http://localhost:8082';

export const createRoom = async (playerName: string): Promise<{roomId:string,playerId:string}> => {
    const apiUrl = `${BASE_URL}/create-room`;
    const playerId = uuidv4();
    const data = {
        playerId,
        playerName
    }

    try {
        const response = await fetch(apiUrl, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify(data),
        });

        if (!response.ok) {
            const errorMessage = await response.text();
            throw new Error(`Failed to create room: ${errorMessage}`);
        }
        // localStorage.setItem('playerId', playerId);
        const roomId = await response.text();
        return {
            roomId,
            playerId
        }
    } catch (error) {
        console.error("Error creating room:", error);
        throw error;
    }
};

export const joinRoom = async (roomId: string, playerName: string): Promise<{roomId:string,playerId:string}> => {
    const apiUrl = `${BASE_URL}/join-room`;
    const playerId = uuidv4();
    try {
        const response = await fetch(apiUrl, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({ roomId, playerId, playerName }),
        });

        if (!response.ok) {
            const errorMessage = await response.text();
            throw new Error(`Failed to join room: ${errorMessage}`);
        }
        
        return {
            roomId,
            playerId
        }
    } catch (error) {
        console.error("Error joining room:", error);
        throw error;
    }
};
```

## File: src/lib/types.ts
```typescript
export default interface GameState {
    players: Player[];
    hands: { title: string; id: string }[][];
    currentPlayerIndex: number;
    gameStatus: string;
    winner?: string;
}

export interface PlayerView {
    playerIndex: number
    players: Player[];
    hand: { title: string; id: string }[];
    currentPlayerIndex: number;
    gameStatus: string;
    winner?: string;
}

export interface Player {
    id: string,
    name: string,
    isConnected: boolean
}

export interface PlayerLobby{
    playerName: string;
    playerId: string;
    title: string | null;
}
```

## File: src/lib/utils.ts
```typescript
import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}
```

## File: src/store/indexedDB.ts
```typescript
import { openDB, IDBPDatabase } from 'idb';
import { PlayerView } from "@/lib/types";

interface GameDB {
    playerViews: PlayerView;  
}

const DB_NAME = 'GameDB';
const DB_VERSION = 1;
const PLAYER_VIEW_KEY = 'gameState';

export async function initDB(): Promise<IDBPDatabase<GameDB>> {
    return openDB<GameDB>(DB_NAME, DB_VERSION, {
        upgrade(db) {
            if (!db.objectStoreNames.contains('playerViews')) {
                db.createObjectStore('playerViews');  
            }
        },
    });
}


export async function savePlayerView(playerView: PlayerView): Promise<void> {
    const db = await initDB();
    await db.put('playerViews', playerView, PLAYER_VIEW_KEY);  
}


export async function getPlayerView(): Promise<PlayerView | undefined> {
    const db = await initDB();
    return db.get('playerViews', PLAYER_VIEW_KEY);  
}

export async function deletePlayerView(): Promise<void> {
    const db = await initDB();
    await db.delete('playerViews', PLAYER_VIEW_KEY);  
}
```

## File: .gitignore
```
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/versions

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# env files (can opt-in for committing if needed)
.env*

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts
```

## File: components.json
```json
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "new-york",
  "rsc": true,
  "tsx": true,
  "tailwind": {
    "config": "tailwind.config.ts",
    "css": "src/app/globals.css",
    "baseColor": "zinc",
    "cssVariables": true,
    "prefix": ""
  },
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  },
  "iconLibrary": "lucide"
}
```

## File: next.config.ts
```typescript
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  /* config options here */
};

export default nextConfig;
```

## File: package.json
```json
{
  "name": "parchi-app",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  },
  "dependencies": {
    "@radix-ui/react-dialog": "^1.1.2",
    "@radix-ui/react-label": "^2.1.0",
    "@radix-ui/react-popover": "^1.1.2",
    "@radix-ui/react-slot": "^1.1.0",
    "class-variance-authority": "^0.7.0",
    "clsx": "^2.1.1",
    "idb": "^8.0.1",
    "lucide-react": "^0.456.0",
    "next": "15.0.3",
    "react": "18.3.1",
    "react-confetti": "^6.1.0",
    "react-dom": "18.3.1",
    "react-icons": "^5.3.0",
    "tailwind-merge": "^2.5.4",
    "tailwindcss-animate": "^1.0.7",
    "uuid": "^11.0.3"
  },
  "devDependencies": {
    "@types/node": "^20",
    "@types/react": "^18",
    "@types/react-dom": "^18",
    "postcss": "^8",
    "tailwindcss": "^3.4.1",
    "typescript": "^5"
  }
}
```

## File: postcss.config.mjs
```
/** @type {import('postcss-load-config').Config} */
const config = {
  plugins: {
    tailwindcss: {},
  },
};

export default config;
```

## File: README.md
```markdown
This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).

## Getting Started

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.
```

## File: tailwind.config.ts
```typescript
import type { Config } from "tailwindcss";

export default {
    darkMode: ["class"],
    content: [
    "./src/pages/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/components/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/app/**/*.{js,ts,jsx,tsx,mdx}",
  ],
  theme: {
  	extend: {
  		colors: {
  			background: 'hsl(var(--background))',
  			foreground: 'hsl(var(--foreground))',
  			primary: {
  				DEFAULT: 'hsl(var(--primary))',
  				foreground: 'hsl(var(--primary-foreground))'
  			},
  			'primary-foreground': 'var(--primary-foreground)',
  			secondary: {
  				DEFAULT: 'hsl(var(--secondary))',
  				foreground: 'hsl(var(--secondary-foreground))'
  			},
  			'secondary-foreground': 'var(--secondary-foreground)',
  			accent: {
  				DEFAULT: 'hsl(var(--accent))',
  				foreground: 'hsl(var(--accent-foreground))'
  			},
  			'accent-foreground': 'var(--accent-foreground)',
  			destructive: {
  				DEFAULT: 'hsl(var(--destructive))',
  				foreground: 'hsl(var(--destructive-foreground))'
  			},
  			'destructive-foreground': 'var(--destructive-foreground)',
  			muted: {
  				DEFAULT: 'hsl(var(--muted))',
  				foreground: 'hsl(var(--muted-foreground))'
  			},
  			'muted-foreground': 'var(--muted-foreground)',
  			card: {
  				DEFAULT: 'hsl(var(--card))',
  				foreground: 'hsl(var(--card-foreground))'
  			},
  			'card-foreground': 'var(--card-foreground)',
  			popover: {
  				DEFAULT: 'hsl(var(--popover))',
  				foreground: 'hsl(var(--popover-foreground))'
  			},
  			'popover-foreground': 'var(--popover-foreground)',
  			border: 'hsl(var(--border))',
  			input: 'hsl(var(--input))',
  			ring: 'hsl(var(--ring))',
  			chart: {
  				'1': 'hsl(var(--chart-1))',
  				'2': 'hsl(var(--chart-2))',
  				'3': 'hsl(var(--chart-3))',
  				'4': 'hsl(var(--chart-4))',
  				'5': 'hsl(var(--chart-5))'
  			}
  		},
  		borderRadius: {
  			default: 'var(--radius)',
  			lg: 'var(--radius)',
  			md: 'calc(var(--radius) - 2px)',
  			sm: 'calc(var(--radius) - 4px)'
  		},
  		fontFamily: {
  			pencil: ['var(--font-pencil)', 'sans-serif']
  		}
  	}
  },
  plugins: [require("tailwindcss-animate")],
} satisfies Config;
```

## File: tsconfig.json
```json
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}
```
